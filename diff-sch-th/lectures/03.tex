\section{Точні та узагальнені розв'язки диференціальних та різницевих рівнянь у банахових просторах}

\shortLectureDescription{Поняття точного та узагальненого розв'язків диференціальних та різницевих рівнянь у банахових просторах. Розв'язуючі оператори. Коректність постановок задач. Збіжність та стійкість. Теорема Лакса. \cite{gryschenko2005, richtmyer1972}}

Нехай $B$ --- нормований банаховий простір. Функції, які залежать від просторових змінних $x$ і координати часу $t$, при фіксованому $t$ будемо тлумачити як точки цього функціонального простору і позначати їх символом $u$. Стан фізичної системи зображатимемо точкою функціонального простору, а її положення в часі відображатиме рух цієї точки у функціональному просторі $B$. Через $\tilde{\RR}_n$  позначимо $n$-вимірний комплексний евклідів векторний простір зі скалярним добутком
\begin{equation*}
    \left(\vec a, \vec b\right) = \sum_{j = 1}^n a_j \bar b_j
\end{equation*}
і нормою
\begin{equation*}
    \|\vec a\| = \sqrt{\sum_{j = 1}^n a_j \bar a_j}.
\end{equation*}

Введемо також допоміжний нормований простір $B'$, елементами якого є довільні неперервні криві, які при кожному $t \in [0, T]$, визначені як функції просторових змінних $w(t) \in B$. В $B'$ введемо норму так:
\begin{equation*}
    \|w\|_{B'} = \max_{0 \le t \le T} \|w(t)\|_B.
\end{equation*}

\subsection{Cкінченно-різницеві задачі в абстрактних просторах Банаха}

Розглянемо однопараметричне сімейство елементів $u(t) \in B$ з дійсним параметром $t$ таких, що 
\begin{equation}
    \label{eq:3.1}
    \frac{\partial u(t)}{\partial t} = A u(t); \quad u(0) = u_0; \quad 0 \le t \le T,
\end{equation}
де $u_0$ --- заданий елемент з $B$, який характеризує початковий стан системи; $A$ --- лінійний оператор. \medskip

\begin{definition}
    \textit{Точний розв'язок} задачі визначимо як однопараметричне сімейство $u(t)$, кожен елемент якого належить області визначення оператора $A$, $\forall t \in [0, T]$, $u(0) = u_0$ і
    \begin{equation}
        \label{eq:3.2}
        \left\| \frac{u(t + \Delta t) - u(t)}{\Delta t} - A u(t) \right\| \to 0,
    \end{equation}
    при $\Delta t \to 0$, $\forall t \in [0, T]$.
\end{definition}

Позначимо через $D$ множину елементів $u_0 \in B$, для кожного з яких існує єдиний розв'язок задачі \eqref{eq:3.1} при $u(0) = u_0$, а збіжність в \eqref{eq:3.2} рівномірна за $t$. Нехай $E_0(T)$ відображає $D$ в $B$ і при фіксованому $t$ встановлює відповідність між $u_0$ і $u(t)$. Тоді $u(t) = E_0(T) u_0$ є розв'язком задачі для тих $u_0 \in B$, для яких існує точний розв'язок.

\begin{definition}
    Задачі, визначені лінійним оператором $A$, назвемо \textit{коректними за Адамаром}, якщо: 
    \begin{enumerate}
        \item область визначення $D$ перетворення $E_0(t)$ щільна в $B$;
        \item сімейство перетворень $E_0(t)$ рівномірно обмежене, тобто існує така додатна стала $K \in \RR$, що $\|E_0(t)\| \le K$ при $0 \le t \le T$. 
    \end{enumerate}
\end{definition}

Перша умова стверджує, що якщо для деякого початкового значення $u_0$ точний розв'язок не існує, то цей початковий елемент можна апроксимувати як завгодно точно з допомогою тих початкових елементів з $D$, для яких існує точний розв'язок. З другої умови випливає, що розв'язок задачі неперервно залежить від початкового значення. 

\subsection{Узагальнені розв'язки диференціальних рівнянь}

\begin{theorem}[теорема про розширення оператора]% \cite{richtmyer1972}]
    Обмежений лінійний оператор $T$, область визначення якого щільна в $B$, має єдине лінійне обмежене розширення $T'$, область визначення якого співпадає з $B$, і таке, що $\|T\| = \|T'\|$.
\end{theorem}

\begin{definition}
    Обмежений лінійний оператор $E_0(t)$ з щільною в $B$ областю визначення має єдине розширення $E(t)$, яке назвемо \textit{узагальненим розв'язуючим оператором}.
\end{definition}

Оператор $E(t)$ визначений на всьому просторі $B$, обмежений за нормою тим же числом $K$, що і оператор $E_0(t)$. 

\begin{definition}
    Рівність 
    \begin{equation*}
        % \label{eq:3.3}
        u(t) = E(t) u_0
    \end{equation*}
    є \textit{узагальненим розв'язком задачі} для довільного початкового елемента $u_0 \in B$.
\end{definition}

Якщо оператор $A$ явним чином залежить від часу, то узагальнений розв'язуючий оператор стає функцією двох змінних. Дійсно, оскільки в момент часу $t_0$ задано початковий стан $u_0$, то $u(t) = E(t, t_0) u_0$ і в силу напівгрупової властивості $E(t_2, t_0) = E(t_2, t_1) E(t_1, t_0)$ при $t_0 \le t_1 \le t_2$. \medskip

Розглянемо неоднорідну крайову задачу
\begin{equation}
    \label{eq:3.3}
    \frac{\partial u(t)}{\partial t} - A u(t) = g(t), \quad u(0) = u_0,
\end{equation}
де $u_0$ і $g(t)$ задані, а $g(t)$ рівномірно або кусково рівномірно неперервна (в  нормі простору $B$) за часом $t$ функція на відрізку $0 \le t \le T$. Вважаємо, що оператор $A$, який визначає коректно поставлену однорідну задачу, замкнений, а області визначення всіх його степенів щільні в $B$. \medskip

Наступні твердження доводяться в \cite{richtmyer1972}:
\begin{proposition}
    Якщо 
    \begin{enumerate}
        \item $u_0$ і $g(t) \in D(A)$; 
        \item $g(t) \in D(A^2)$; 
        \item функції $A g(t)$ і $A^2 g(t)$ неперервні,
    \end{enumerate}
    то 
    \begin{equation}
        \label{eq:3.4}
        u(t) = E(t) u_0 + \int_0^t E(t - s) g(s) \diff s
    \end{equation}
    є \textit{точним розв'язком задачі} \eqref{eq:3.3}.
\end{proposition}

\begin{proposition}
    Якщо на $u_0$ і $g(t)$  не накладено ніяких обмежень, крім неперервності $g(t)$, або ці умови зводяться тільки до умови існування інтегралу в \eqref{eq:3.4}, то \eqref{eq:3.4} є узагальненим розв'язком задачі \eqref{eq:3.3}.
\end{proposition}

\begin{proposition}
    При вказаних вимогах відносно оператора $A$ і функції $g(t)$ узагальнений розв'язок існує.
\end{proposition}

\begin{remark}
    Єдиність розв'язку випливає з єдиності однорідної задачі, яка за припущенням поставлена коректно. 
\end{remark}

\subsection{Скінченно-різницеві задачі}

Розглянемо однорідне скінченно-різницеве рівняння 
\begin{equation}
    \label{eq:3.4'}
    B_1 u^{n + 1} = B_0 u^n,
\end{equation}
де $B_0 = B_0(\Delta t, \Delta x_1, \Delta x_2, \ldots)$ і $B_1 = B_1(\Delta t, \Delta x_1, \Delta x_2, \ldots)$ --- лінійні скінченно–різницеві оператори, залежні від приростів $\Delta t, \Delta x_1, \Delta x_2, \ldots$ і можливо від просторових змінних. Обидві частини рівняння є лінійними функціями значень $u$, визначених в точках з деякої множини (шаблону). \medskip

Нехай існує обернений оператор $B_1^{-1}$, $B_1^{-1} B_0$ обмежений і вони визначені на всьому $B$, а $\Delta x_i = q_i(\Delta t)$, $i = \overline{1,d}$, де $d$ --- розмірність простору. Позначимо
\begin{equation*}
    B_1^{-1}(\Delta t, \Delta x_1, \Delta x_2, \ldots) \cdot B_0(\Delta t, \Delta x_1, \Delta x_2, \ldots) = C(\Delta t)
\end{equation*}
тоді 
\begin{equation}
    \label{eq:3.5}
    u^{n + 1} = C(\Delta t) u^n.
\end{equation}

\begin{definition}
    Сімейство операторів $C(\Delta t)$ \textit{узгоджено апроксимує} крайову задачу \eqref{eq:3.1}, якщо для довільного $u(t)$ з деякого класу $U$ точних розв'язків, початкові елементи яких утворюють в $B$ щільну множину, справедлива \textit{умова узгодження}:
    \begin{equation}
        \label{eq:3.6a}
        \left\| \left( \frac{C(\Delta t) - I}{\Delta t} - A \right) u(t) \right\| \to 0,
    \end{equation}
    при $\Delta t \to 0$, $0 \le t \le T$.
\end{definition}

Тут $I$ --- одиничний оператор.

\begin{definition}
    Враховуючи \eqref{eq:3.2}, маємо
    \begin{equation}
        \label{eq:3.6b}
        \left\| \frac{u(t + \Delta t) - C(\Delta t) u(t)}{\Delta t} \right\| \to 0,
    \end{equation}
    при $\Delta t \to 0$, $0 \le t \le T$, в якому вираз під знаком норми є \textit{похибкою апроксимації}.
\end{definition}

Якщо $\forall \epsilon > 0$ $\exists \delta > 0$ таке, що 
\begin{equation}
    \label{eq:3.6c}
    \left\| \left( C(\Delta t) - E(\Delta t) \right) u(t) \right\| < \epsilon \Delta t,
\end{equation}
при $0 \le t \le T$, $0 < \Delta t < \delta$, то \textit{збіжність рівномірна} за часом $t$.

\begin{definition}
    Сімейство $C(\Delta t)$ забезпечує \textit{збіжну апроксимацію} задачі, якщо для будь-якого фіксованого $t \in [0, T]$, для кожного $u_0 \in B$ і для кожної збіжної до нуля послідовності додатних приростів $\{\Delta_j t\}_{j = 1}^\infty$, має місце граничне відношення 
    \begin{equation}
        \label{eq:3.7}
        \left\| C(\Delta_j t)^{n_j} u_0 - E(t) u_0 \right\| \to 0
    \end{equation}
    при $j \to \infty$, де $n_j \in \NN$ такі, що $n_j \Delta_j t \to t$ при $j \to \infty$.
\end{definition}

\begin{definition}
    Апроксимацію $C(\Delta t)$ назвемо \textit{стійкою}, якщо для деякого $\tau > 0$ нескінченна множина операторів 
    \begin{equation}
        \label{eq:3.9}
        C(\Delta t)^n, \quad 0 \le n \Delta t \le T, \quad 0 < \Delta t < \tau
    \end{equation}
    рівномірно обмежена. 
\end{definition}

\subsection{Теорема Лакса}

\begin{theorem}[Лакса, про еквівалентність]
    Нехай задача \eqref{eq:3.1}--\eqref{eq:3.2} коректно поставлена та її скінченно-різницева апроксимація задовольняє умову узгодження. Тоді стійкість необхідна і достатня для збіжності.
\end{theorem}

\begin{proof}
    \textbf{Необхідність.} Спочатку ми покажемо, що збіжна схема необхідно є стійкою. Ми cтверджуємо, що для всякої збіжної схеми й для довільного початкового фіксованого елемента $u_0 \in B$ величини $\|C(\Delta t)^n u_0\|$, ($0 < \Delta t < \tau$, $0 \le n \Delta t \le T$), обмежені при деякому $\tau > 0$. Дійсно, якщо це не так, то знайдуться дві послідовності $\Delta_1 t, \Delta_2 t, \ldots, \Delta_j t, \ldots$ і $n_1, n_2, \ldots, n_j, \ldots$, для яких норми елементів $C(\Delta_1)^{n_1} t, C(\Delta_2)^{n_2} t, \ldots, C(\Delta_j)^{n_j} t, \ldots$ необмежено зростають (при цьому $\Delta_j t$ повинні прямувати до нуля в силу припущення про неперервну залежність $C(\Delta t)$ від додатних значень $\Delta t$); із цих елементів ми можемо вибрати підпослідовність, для якої величини $n_j \delta_j t$ збігаються до деякого $t$ з відрізка  $0 \le t \le T$; але це суперечить припущенню про збіжність схеми, оскільки при наявності збіжності норми елементів цієї підпослідовності повинні були б прямувати до кінцевої границі $\|E(t)u_0\|$. Отже, існує така функція $K_1(u)$, що неперервність $\|C(\Delta t) n u_0\| \le K_1(u)$ виконується для всіх операторів з множини \eqref{eq:3.9} і всіх $u \in B$, отже множина \eqref{eq:3.9} рівномірно обмежена. Таким чином, апроксимація стійка. \medskip

    \textbf{Достатність.} Щоб довести зворотне твердження, припустимо, що $u(t) = E(t)u_0$ є точним розв'язком, що належать класу $U$, про який йшла мова при визначенні узгодженості. Нехай  $\epsilon, \delta$ ті ж, що й в умові узгодженості у формі \eqref{eq:3.6c}, $n_j$ і $\Delta_j t$ обрані так само, як і при визначенні збіжності, а $\psi_j$ позначає різницю між обчисленим і точним значенням і в момент часу  $n_j \Delta_j t$, тобто
    \begin{multline}
        \label{eq:3.10}
        \psi_j = \Big[ C(\Delta_j t)^{n_j} - E(n_j \Delta_j t) \Big] = \\
        = \sum_{k = 0}^{n_j} C(\Delta_j t)^k \Big[ C(\Delta_j t) - E(\Delta_j t) \Big] E((n_j - 1 - k) \Delta_j t) u_0.
    \end{multline}
    
    Третя частина цієї рівності, співпадає з другою: після приведення подібних залишаються тільки перший і останній члени. Норму величини $\psi_j$ можна оцінити за допомогою \eqref{eq:3.6c} і нерівності трикутника: якщо $0 < \Delta_j t < \delta$, то
    \begin{equation}
        \label{eq:3.11}
        \|\psi_j\| \le K_2 \sum_{k = 0}^{n_j - 1} \epsilon \Delta_j t = K_2 \epsilon n_j \Delta_j t \le K_2 \epsilon T,
    \end{equation}
    де $K_2$ позначає рівномірну границю множини \eqref{eq:3.9}. Оскільки $\epsilon$ довільне, то $\|\psi_j\| \to 0$ при $\Delta_j t \to 0$, $n_j \Delta_j t \to t$. Для доведення збіжності покажемо, що в граничному переході при $j \to \infty$ в \eqref{eq:3.10} можна замінити $E(n_j \Delta_j t)$ на $E(t)$. Якщо $s = |t - n_j \Delta_j t|$, $t' = \min\{t, n_j \Delta_j t\}$, то в силу напівгрупової властивості сім'ї $E(t)$ маємо $E(s + t') = E(s) E(t)$, тому $E(n_j \Delta_j t) - E(t) = \pm (E(s) - I) E(t')$, причому знак визначається знаком різниці $t - n_j \Delta_j t$. У будь-якому випадку
    \begin{equation}
        \| (E(n_j \Delta_j t) - E(t)) u_0 \| \le K_E \| (E(s) - I) u_0 \|,
    \end{equation}
    де $K_E$ позначає границю для $\|E(t)\|$ при $0 \le t \le T$. Але права частина останньої нерівності прямує до нуля, якщо $s \to 0$, тобто якщо $j \to \infty$. Отже, величина 
    \begin{equation}
        \| (E(s) - I) u_0 \|
    \end{equation}
    може бути зроблена як завгодно малою вибором достатньо малих $\Delta_j t$ і $|t - n_j \Delta_j t|$. Це справедливо для довільного $u_0$, що є початковим елементом точного розв'язку із класу $U$: але такі елементи щільні в $B$, тому для довільного $u \in B$ з них можна вибрати послідовність $u_1, u_2, \ldots$ збіжну до $u$. Тому
    \begin{equation}
        \label{eq:3.12}
        \Big( C(\Delta_j t)^{n_j} - E(t) \Big) u = \Big( C(\Delta_j t)^{n_j} - E(t) \Big) u_m + C(\Delta_j t)^{n_j} (u - u_m) - E(t) (u - u_m).
    \end{equation}
    
    Тут два останні члени в правій частині можуть бути зроблені як завгодно малими за допомогою вибору досить великого $m$, оскільки клас \eqref{eq:3.9} і множина операторів $E(t)$ рівномірно обмежені, а малість першого члена може бути забезпечена за рахунок вибору достатньо малих $\Delta_j t$ і $|t - n_j \Delta_j t|$. Оскільки $u$ --- довільний елемент із $B$, то збіжність встановлена й теорема про еквівалентність доведена.
\end{proof}

Відзначимо в якості природнього наслідку цієї теореми, що для даного початкового елемента $u_0$ збіжність рівномірна по $t$ на відрізку $[0, T]$ у тому розумінні, що обмеження, які потрібно накладати на $\Delta_j t$ і $|t - n_j \Delta_j t|$, щоб зробити \eqref{eq:3.12} нескінченно малим, не залежать ні від вибору $t$, ні від вибору послідовності $\Delta_j t$. Ця обставина має велике практичне значення, тому що дозволяє при чисельному інтегруванні знаходити такий крок $\Delta t$, при якому наближений розв'язок виявляється досить точним на всьому відрізку $[0, T]$ одночасно. Часто для досягнення потрібної точності $\Delta t$ варіюють у процесі обчислень, але існує таке граничне додатнє значення $\Delta t$, нижче якого заходити нема рації. \medskip

Викладену теорему Лакса можна дуже просто застосувати до неявного різницевого рівняння для одномірного завдання дифузії
\begin{equation}
    \frac{u_j^n - u_j^{n - 1}}{\Delta t} = \sigma \frac{u_{j + 1}^n - 2 u_j^n + u_{j - 1}^n}{(\Delta x)^2}.
\end{equation}
 
Насамперед  покажемо, що розв'язок цього рівняння задовольняє наступному принципу максимуму. Припустимо, що рівняння розглядається в прямокутнику $0 \le x \le a$, $0 \le t \le T$ і що $\Delta x$ вибирається рівним $a / J$, де $J$ --- натуральне число. Тоді максимальне значення $M_1$, що досягається величиною $u_j^n$ усередині цього прямокутника, не може перевищувати максимального значення $M_2$, що досягається початковими й граничними значеннями (тобто значеннями на відрізках прямих $t = 0$, $x = 0$, $x = a$). Дійсно, припустимо протилежне, а саме що $M_1 > M_2$, і нехай $(n,j)$ --- перша внутрішня точка сітки, у якій $u_j^n = M_1$ (перша у тому розумінні, що індекси $n$ і $j$ мають найменші значення). Тоді в цій точці сітки ліва частина наведеного вище рівняння повинна бути додатна, а права від'ємна, тому що $u_j^n$ за припущенням перевершує сусіднє значення $u_{j - 1}^n$ ліворуч і сусіднє значення $u_j^{n - 1}$ знизу й щонайменше дорівнює сусідньому значенню $u_{j + 1}^n$  праворуч. Отже, наше припущення неправильне, і принцип максимуму встановлений. Очевидно, що ці міркування можна застосувати й до $-u_j^n$ і тим самим установити, що $|u_j^n|$ обмежені при будь-якому виборі сітки, тобто що розглянуте різницеве рівняння стійке. \medskip


Система різницевих рівнянь для задачі \eqref{eq:3.3} має вигляд
\begin{equation}
    B_1 u^{n + 1} - B_0 u^n = g^{n + 1}, \quad u^0 = u_0,
\end{equation}
де $B_1$ і $B_0$ --- розглянуті раніше різницеві оператори, а $g^n$ апроксимує $g(n \Delta t)$. Якщо величину $\|g^n - g(n \Delta t)\|$ можна зробити як завгодно малою рівномірно за $n$ при $0 \le n \Delta t \le T$ за допомогою вибору $\Delta t$, то останнє різницеве рівняння можна подати у вигляді
\begin{equation}
    \label{eq:3.6}
    u^{n + 1} - C(\Delta t) u^n = D(\Delta t) g^{n + 1},
\end{equation}
де $C(\Delta t) = B_1^{-1} B_0$ і $D(\Delta t) = B_1^{-1}$ обмежені і залежать тільки від $\Delta t$ і, можливо, координат, а $\Delta x_i$ можуть бути виражені через $\Delta t$. \medskip

З \eqref{eq:3.6} випливає
\begin{equation}
    u^n = C(\Delta t)^n u_0 + \Delta t \sum_{j = 1}^n C(\Delta t)^{n - j} g^j.
\end{equation}

Якщо виконуються умови теореми Лакса, то остання сума апроксимує інтеграл з \eqref{eq:3.4}, звідки випливає збіжність наближеного розв'язку до точного.
