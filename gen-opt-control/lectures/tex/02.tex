\subsection{Властивості дробових похідних}

\subsubsection{Похідні степеневих функцій}

Знайдемо похідні степеневих функцій. Нехай $\beta > -1$, $0 < \alpha < 1$. Тоді, безпосередньо за визначення дробової похідної Рімана-Ліувілля
\begin{equation}
    \RLFdiff{\alpha} t^\beta = \frac{\diff}{\diff t} \Fint{1-\alpha} t^\beta.
\end{equation}

У свою чергу, безпосередньо за визначенням дробового інтеграла
\begin{equation}
    \Fint{1-\alpha} t^\beta = \frac{1}{\Gamma(1 - \alpha)} \int_0^t s^\beta (t- s)^{-\alpha} \diff s.
\end{equation}

\begin{reminder}
    \nothing
    \begin{definition}[бета-функції]
        \begin{equation}
            B(a, b) = \int_0^1 \xi^{a-1}(1-\xi)^{b-1} \diff \xi,
        \end{equation}
    \end{definition}
    
    \begin{property}[бета-функції]
        \begin{equation}
            B(x, y) = \frac {\Gamma (x) \Gamma (y)}{\Gamma (x + y)}.
        \end{equation}
    \end{property}
\end{reminder}

Проведемо заміну $\xi = s / t$, тоді $\diff s = t \diff \xi$, отримаємо
\begin{equation}
    \begin{aligned}
        & \frac{1}{\Gamma(1-\alpha)} \int_0^1 (t \xi)^\beta t^{-\alpha} (1 - \xi)^{-\alpha} t \diff \xi = \\
        &\quad = \frac{t^{\beta - \alpha + 1}}{\Gamma(1 - \alpha)} \cdot B(\beta + 1, 1 - \alpha) = \\
        &\quad = \frac{\Gamma(\beta + 1)}{\Gamma(2 + \beta - \alpha)} \cdot t^{\beta - \alpha + 1}.
    \end{aligned}
\end{equation}

Лишилося продиференціювати  цей інтеграл:
\begin{equation}
    \begin{aligned}
        & \RLFdiff{\alpha} \left( \frac{\Gamma(\beta + 1)}{\Gamma(2 + \beta - \alpha)} \cdot t^{\beta - \alpha + 1} \right) = \\
        &\quad = \frac{\Gamma(\beta + 1)}{\Gamma(2 + \beta - \alpha)} \cdot (\beta - \alpha + 1) t^{\beta - \alpha} = \\
        &\quad = \frac{\Gamma(\beta + 1)}{\Gamma(1 + \beta - \alpha)} \cdot t^{\beta - \alpha},
    \end{aligned}
\end{equation}
де в останньому переході ми скористалися властивістю $z \Gamma(z) = \Gamma(z + 1)$.

\begin{remark}
    Ця формула справедлива і для $\alpha \ge 1$, але умова $\beta > -1$ важлива для збіжності кількох інтегралів, зокрема
    \begin{equation}
        \int_0^t s^\beta (t- s)^{-\alpha} \diff s.
    \end{equation}
\end{remark}

\begin{example}
    Зокрема, якщо $\NN \ni \alpha \le \beta \in \NN$, то маємо формулу
    \begin{equation}
        \frac{\diff^\alpha}{\diff t^\alpha} t^\beta = \frac{\beta!}{(\beta - \alpha)!} \cdot t^{\beta - \alpha}.
    \end{equation}
    Наприклад,
    \begin{equation}
        \frac{\diff^2}{\diff t^2} t^4 = \frac{4!}{2!} \cdot t^2.
    \end{equation}
\end{example}

\begin{remark}
    Зрозуміло також, що всі введені нами оператори лінійні.
\end{remark}

\subsubsection{Властивості похідних Рімана-Ліувілля}

\begin{proposition}
    На жаль, не виконується наступна властивість
    \begin{equation}
        \frac{\diff^n}{\diff t^n} e^{\lambda t} = \lambda^n e^{\lambda t}.
    \end{equation}
\end{proposition}

\begin{proof}
    \begin{equation}
        e^{\lambda t} = \sum_{k = 0}^\infty \frac{(\lambda t)^k}{k!}.
    \end{equation}
    Почленно диференціюємо:
    \begin{equation}
        \begin{aligned} 
            \RLFdiff{\alpha} e^{\lambda t} 
            &= \RLFdiff{\alpha} \left( \sum_{k = 0}^\infty \frac{(\lambda t)^k}{k!} \right) = \\
            &= \sum_{k = 0}^\infty \frac{\lambda^k}{k!} \RLFdiff{\alpha} ( t^k ) = \\
            &= \sum_{k = 0}^\infty \frac{\lambda^k}{k!} \frac{k!}{\Gamma(k + 1 - \alpha)} \cdot t^{k - \alpha} \ne \\
            &\ne \sum_{k = 0}^\infty \lambda^\alpha \frac{(\lambda t)^k}{k!}.
        \end{aligned}
    \end{equation}
\end{proof}

Нагадаємо основні співвідношення між похідними та інтегралами із класичного аналізу:
\begin{th_formula}[(не) Ньютона-Лейбніца]
    \begin{equation}
        \frac{\diff}{\diff t} \int_0^t f(s) \diff s = f(t),
    \end{equation}
\end{th_formula}
а також
\begin{th_formula}[Ньютона-Лейбніца]
    \begin{equation}
        \int_0^t f'(s) \diff s = f(t) - f(0).
    \end{equation}
\end{th_formula}

Важливою для подальшого аналізу є
\begin{property}[дробових інтегралів, напівгрупова]
    Нехай $\alpha > 0$, $\beta > 0$, тоді $\Fint{\alpha + \beta} \equiv \Fint{\alpha} \Fint{\beta}$.
\end{property}

\begin{exercise}
    Доведіть цю властивість. \textbf{Підказка}: за означеннями,
    \begin{equation}
        \Fint{\alpha + \beta} f \equiv f \star y_{\alpha + \beta} \overset{?}{\equiv} f \star (y_\alpha \star y_\beta) \overset{?}{\equiv} (f \star y_\alpha) \star y_\beta \equiv \Fint{\beta} \Fint{\alpha} f,
    \end{equation}
    тому достатньо перевірити асоціативність згортки і рівність $y_{\alpha + \beta} \equiv y_\alpha \star y_\beta$.
\end{exercise}
% \begin{proof}
%     Перевіримо два вищезгаданих твердження:
%     \begin{enumerate}
%         \item Асоціативність $\star$ отримується ``в лоб'':
%         \begin{equation}
%             \begin{aligned}
%                 ((f \star g) \star h)(t) &=
%                 \int_0^t (f \star g)(s) h(t - s) \diff s = \\
%                 &= \int_0^t ( \int_0^\xi f(\xi) g(s - \xi) \diff \xi ) h(t - s) \diff s = \\
%                 &= \int_0^t \int_0^s f(\xi) g(s - \xi) h(t - s) \diff \xi \diff s = \\
%                 &= \int_0^t \int_\xi^t f(\xi) g(s - \xi) h(t - s) \diff s \diff \xi = \\
%                 &= \int_0^t \int_0^{t - \xi} f(\xi) g(s) h(t - s - \xi) \diff s \diff \xi = \\
%                 &= \int_0^t f(\xi) ( \int_0^{t - \xi} g(s) h(t - \xi - s) \diff s ) \diff \xi = \\
%                 &= \int_0^t f(\xi) (g \star h)(t - \xi) \diff \xi = \\
%                 &= (f \star (g \star h))(t).
%             \end{aligned}
%         \end{equation}
%         \item Далі
%         \begin{equation}
%             \begin{aligned}
%                 y_\alpha(t) \star y_\beta(t) 
%                 &= \int_0^t y_\alpha(s) y_\beta(t - s) \diff s = \\
%                 &= \int_0^t \frac{1}{\Gamma(\alpha)} s^{\alpha - 1} \frac{1}{\Gamma(\beta)} (t - s)^{\beta - 1} \diff s = \\
%                 &= \frac{1}{\Gamma(\alpha) \Gamma(\beta)} \int_0^t s^{\alpha - 1} (t - s)^{\beta - 1} \diff s.
%             \end{aligned}
%         \end{equation}
        
%         Проведемо заміну $\xi = s / t$, тоді $\diff s = t \diff \xi$, отримаємо
%         \begin{equation}
%             \begin{aligned}
%                 & \frac{1}{\Gamma(\alpha) \Gamma(\beta)} \int_0^t s^{\alpha - 1} (t - s)^{\beta - 1} \diff s = \\
%                 &\quad = \frac{1}{\Gamma(\alpha) \Gamma(\beta)} \int_0^t (\xi t)^{\alpha - 1} (1 - \xi)^{\beta - 1} t^{\beta - 1} t \diff \xi = \\
%                 &\quad = \frac{1}{\Gamma(\alpha) \Gamma(\beta)} t^{(\alpha - 1) + (\beta - 1) + 1} \int_0^t \xi^{\alpha - 1} (1 - \xi)^{\beta - 1} \diff \xi = \\
%                 &\quad = \frac{1}{\Gamma(\alpha) \Gamma(\beta)} t^{\alpha + \beta - 1} B(\alpha, \beta) = \\
%                 &\quad = \frac{1}{\Gamma(\alpha) \Gamma(\beta)} t^{\alpha + \beta - 1} \frac {\Gamma (\alpha) \Gamma (\beta)}{\Gamma (\alpha + \beta)} = \\
%                 &\quad = \frac{1}{\Gamma (\alpha + \beta)} t^{\alpha + \beta - 1} = \\
%                 &\quad = y_{\alpha + \beta}(t).
%             \end{aligned}
%         \end{equation}
%     \end{enumerate}
% \end{proof}

\begin{th_formula}[аналог формули (не) Ньютона-Лейбніца]
    Для $\alpha > 0$
    \begin{equation}
        \RLFdiff{\alpha} \Fint{\alpha} f \equiv f.
    \end{equation}
\end{th_formula}

\begin{proof}
    Нехай $n = \lceil \alpha \rceil$, тоді
    \begin{equation}
        \RLFdiff{\alpha} \Fint{\alpha} f \equiv \frac{\diff^n}{\diff t^n} \Fint{n - \alpha} \Fint{\alpha} f \equiv \frac{\diff^n}{\diff t^n} \Fint{n} f = f. 
    \end{equation}
\end{proof}

\begin{remark}
    Тут ми скористалися напівгруповою властивістю.
\end{remark}

\begin{th_formula}[аналог формули Ньютона-Лейбніца]
        Нехай $f, \RLFdiff{\alpha} f \in L_1([0,T])$, $n = \lceil \alpha \rceil$, $\alpha \not\in \NN$, тоді для $0 < t < T$ маємо
    \begin{equation}
        (\Fint{\alpha} \RLFdiff{\alpha} f)(t) = f(t) - \sum_{k = 0}^{n - 1} (\RLFdiff{\alpha - k  - 1} f)(0) \cdot \frac{t^{\alpha - k - 1}}{\Gamma(\alpha - k)}.
    \end{equation}
\end{th_formula}

\begin{remark}
    Тут під $\RLFdiff{-|\beta|}$ маємо на увазі $\Fint{|\beta|}$.
\end{remark}

\begin{example}
    Для $0 < \alpha < 1$ маємо
    \begin{equation}
        (\Fint{\alpha} \RLFdiff{\alpha} f)(t) = f(t) - (\Fint{1 - \alpha} f)(0) \cdot \frac{t^{\alpha - 1}}{\Gamma(\alpha)}.
    \end{equation}
\end{example}

\begin{remark}
    Тут $(\Fint{1 - \alpha} f)(0) = \lim_{\epsilon \downarrow 0} (\Fint{1 - \alpha} f)(\epsilon)$.
\end{remark}

\begin{proof}
    Доведемо частинний випадок:
    \begin{equation}
        \begin{aligned}
            (\Fint{\alpha} \RLFdiff{\alpha} f)(t) 
            &= \frac{1}{\Gamma(\alpha)} \int_0^t (t - s)^{\alpha - 1} (\RLFdiff{\alpha} f) (s) \diff s = \\
            &= \frac{\diff}{\diff t} \left( \frac{1}{\alpha \Gamma(\alpha)} \int_0^t (t - s)^{\alpha} (\RLFdiff{\alpha} f) (s) \diff s \right).
        \end{aligned}
    \end{equation}

    Виконаємо наступні маніпуляції з виразом що стоїть під похідною:
    \begin{equation}
        \begin{aligned}
            & \frac{1}{\alpha \Gamma(\alpha)} \int_0^t (t - s)^{\alpha} (\RLFdiff{\alpha} f) (t) \diff t = \\
            &\quad = \frac{1}{\alpha \Gamma(\alpha)} \left( \left. (t - s)^{\alpha} (\Fint{1-\alpha} f) (s) \right|_{s = 0}^{s = t} + \alpha \int_0^t (t - s)^{\alpha - 1} (\Fint{1-\alpha} f) (s) \diff s \right) = \\
            &\quad = - \frac{t^\alpha (\Fint{1 - \alpha} f)(0)}{\alpha \Gamma(\alpha)} + \Fint{\alpha} \Fint{1 - \alpha} f = \\
            &\quad = - \frac{t^\alpha (\Fint{1 - \alpha} f)(0)}{\alpha \Gamma(\alpha)} + \Fint{1} f.
        \end{aligned}
    \end{equation}
    Лишилося всього лише продиференціювати:
    \begin{equation}
        \frac{\diff}{\diff t} \left( -\frac{t^\alpha (\Fint{1 - \alpha} f)(0)}{\alpha \Gamma(\alpha)} + \Fint{1} f \right) = f(t) - \frac{t^{\alpha - 1} (\Fint{1 - \alpha} f)(0)}{\Gamma(\alpha)}.
    \end{equation}
\end{proof}

\subsubsection{Властивості похідних за Капуто}
\begin{theorem}
    Нехай $f \in L_\infty([0,T])$, тобто $\exists M \in \RR$: $|f(t)| \overset{\text{a.e.}}{\le} M$, тоді, як і очікувалося,
    \begin{equation}
        (\CFdiff{\alpha} \Fint{\alpha} f)(t) = (\Fint{\alpha} \CFdiff{\alpha} f)(t).
    \end{equation}
\end{theorem}

\begin{theorem}
    Нехай $n = \lceil \alpha \rceil$, $f \in AC^n([0,T])$, тоді
    \begin{equation}
        (\Fint{\alpha} \CFdiff{\alpha} f)(t) = f(t) - \sum_{k = 0}^n \frac{f^{(k)}(0)}{k!} \cdot t^k.
    \end{equation}
\end{theorem}

\begin{remark}
    Ця формула справедлива і для цілих $\alpha$.
\end{remark}

\begin{proposition}
    Для похідних у загальному випадку не виконується напівгрупова властивість.
\end{proposition}

\begin{theorem}
    Нехай $f, \RLFdiff{\beta} \in L_1([0, T])$, $\alpha \not\in \NN$. Тоді
    \begin{equation}
        (\RLFdiff{\alpha} \RLFdiff{\beta} f)(t) = (\RLFdiff{\alpha + \beta} f) (t) - \sum_{k = 0}^{\lceil \beta \rceil - 1} (\RLFdiff{\beta - k - 1} f)(0) \cdot \frac{t^{-\alpha - k - 1}}{\Gamma(-\alpha - k)}
    \end{equation}
\end{theorem}

\begin{example}
    Зокрема, для $0 < \alpha, \beta < 1$:
    \begin{equation}
        ( \RLFdiff{\alpha} \RLFdiff{\beta} f ) (t) = ( \RLFdiff{\alpha + \beta} f ) (t) - ( \Fint{1 - \beta} f ) (0) \cdot \frac{t^{-\alpha - 1}}{\Gamma(-\alpha)}.
    \end{equation}
\end{example}

\begin{proof}
    Доведемо частинний випадок:
    \begin{equation}
        \begin{aligned}
            (\RLFdiff{\alpha} \RLFdiff{\beta} f)(t)
            &= \left( \frac{\diff}{\diff t} \Fint{1 - \alpha} \RLFdiff{\beta} f \right)(t) = \\
            &= \left( \frac{\diff^2}{\diff t^2} \Fint{2 - \alpha} \RLFdiff{\beta} f \right)(t) = \\
            &= \left( \frac{\diff^2}{\diff t^2} \Fint{2 - \alpha - \beta} \Fint{\beta} \RLFdiff{\beta} f \right)(t) = \\
            &= \frac{\diff^2}{\diff t^2} \Fint{2 - \alpha - \beta} \left( f(t) - (\Fint{1 - \beta} f)(0) \cdot \frac{t^{\beta - 1}}{\Gamma(\beta)} \right) = \\
            &= (\RLFdiff{\alpha + \beta} f)(t) - \frac{(\Fint{1 - \beta} f)(0)}{\Gamma(\beta)} \cdot \RLFdiff{\alpha + \beta} t^{\beta-1} = \\
            &= (\RLFdiff{\alpha + \beta} f)(t) - \frac{(\Fint{1 - \beta} f)(0)}{\Gamma(\beta)} \frac{\Gamma(\beta)}{\Gamma(-\alpha)} \cdot t^{-1 - \alpha} = \\
            &= (\RLFdiff{\alpha + \beta} f)(t) - \frac{(\Fint{1 - \beta} f)(0)}{\Gamma(-\alpha)} \cdot t^{-1 - \alpha}.
        \end{aligned}
    \end{equation}
\end{proof}
